pipeline{
        agent any
        
        environment {
        /*
        * Uses a Jenkins credential called "FOOCredentials" and creates environment variables:
        * "$FOO" will contain string "USR:PSW"
        * "$FOO_USR" will contain string for Username
        * "$FOO_PSW" will contain string for Password
        */
        FOO = credentials("dockerhubimageid")
        }
        
        }
        stages{
            stage('Build'){
                steps{
                    sh "echo this is where the building happens"
                    sh "cat README.md"
                    sh "ls -al; pwd"
                    sh "echo cloning repo"
                    // sh "git clone https://github.com/hmahmood2351/HelloWorldFlask" - not needed, already in my repo
                    sh "echo building docker image - application"
                    sh "sudo docker build -t hmahmood2351/helloworldflask /var/lib/jenkins/workspace/testjob/Application/"
                    sh "echo $FOO_USR; echo $FOO_PSW"
                }
            }

            stage('Test'){
                steps{
                    sh "echo this is where the testing happens"
                }
            }
            stage('Deployment'){
                steps{
                    sh "echo this is where the deployment happens"
                    sh "echo pushing up to dockerhub"
                    sh "echo running a cmd that triggers a rolling update on the docker swarm manager, pushing it to workers"
                }
            }
        }
}
